% demo program for ransacfitessmatrix

% some matching points in pixel coords
pts0=[
  402.3410  472.0420  291.6400  430.2490  297.9080  636.8040  477.6620  300.3850  607.5120  559.8160  198.4520  462.7490  470.8440  463.7310  586.9190  307.0630  545.8560  493.1580  510.9820  406.1580 256.8290  411.1210  386.9040  418.8860  443.8640  645.0390  312.3810  409.9190  430.6400  178.7130  363.3870  304.6460  140.0110  283.0300  540.6270  478.7110  452.0700  416.9900  230.3290  555.9470 15.8560  301.3400  512.1680  447.9780  315.8070  175.0030  504.7480  329.5140   15.4450  279.9870  545.9600  346.5800  586.3380  299.0970  328.7420  187.0970  695.7600  323.1660  284.0340  185.0030 298.0610  553.9370  260.0090  305.9720  634.2330  582.8510  265.9360  409.1070  521.8060  375.8440  542.5600  426.9230  456.5680  358.0140  229.6950  285.5100  250.9200  594.5690  473.3970  251.5860 272.6440  437.2910  311.1030  273.5490  416.2710  195.4900  539.8450  456.2020  607.2270  495.6410  543.2560  309.8540  339.5230  376.9980   26.0280  479.5420  476.2070  517.3810  274.1300  192.2890
  355.4990  251.3040  424.3210  336.0580  354.8900  405.3420  268.9670  387.4010  303.9260  298.4980  450.7370  319.5950  319.8600  306.3290  315.9180  370.7280  275.7190  258.0510  326.1800  168.9610 430.9280  282.2980  338.8200  217.7390  339.6310  396.2980  314.6780  380.7050  344.3150  433.2140  283.0990  480.6720  300.8140  229.8380  279.1120  327.0130  321.4130  223.8680  368.6700  322.3070 382.5060  418.7570  313.2870  319.9330  368.9830  414.1030  199.0270  301.7420  394.4610  339.5630  253.5000  379.0930  292.8230  531.6450  314.9700  506.2980  474.9550  412.0300  322.8380  452.9870 323.9580  320.7370  386.8550  351.7580  345.1740  293.8080  332.0720  275.1890  391.3620  358.8480  313.5320  220.4690  311.0470  303.8250  395.2210  325.6300  417.7720  293.7150  264.0760  494.8880 191.0970  220.1080  384.1910  418.8290  423.0690  503.0880  166.4370  255.3480  310.2340  252.1810  247.1000  364.5370  365.7850  391.9710  427.6470  317.8110  258.9780  270.9960  321.9230  363.6650
];

pts1=[
  360.5600  444.3950  233.9680  391.3150  242.2980  591.4530  452.8790  245.6500  638.1500  567.3500  142.4620  435.9900  448.6670  436.3020  606.0410  254.1990  548.9450  473.4690  497.7510  399.0580 197.4650  369.8340  341.5990  393.9970  410.3760  611.0880  255.3650  370.9660  394.5750  122.1260  311.9750  211.1830  132.5090  244.6290  540.0030  461.1420  419.4910  389.0010  170.6370  562.1830 66.6600  246.6820  500.1180  415.5390  264.1840  117.9730  505.1390  273.1930   62.8150  220.9590  546.5070  294.3940  609.2320  163.2930  272.9230  101.9310  597.6990  270.1810  224.9210  127.2700 240.0740  557.1450  200.7870  252.7100  640.9030  599.4810  206.3610  366.3390  479.0630  327.7680  545.3570  397.9360  425.9430  306.7180  169.5730  225.9520  191.2820  623.4210  447.0840  178.0640 247.2730  414.0870  258.3020  214.8950  349.0360  111.2050  563.1380  424.5880  638.7590  476.0620  541.4650  256.7540  286.2140  330.1500   48.8930  461.1260  449.8290  505.8140  215.1970  133.8040
  357.0030  261.9860  401.6270  342.3860  336.8050  457.1320  280.1880  369.0730  341.8080  326.3420  408.1390  331.9680  332.9610  317.8070  351.3120  354.5360  298.1030  272.4230  347.1000  171.1410 401.2720  283.5310  337.7450  221.1390  348.8390  447.8440  301.8400  383.8190  351.7490  388.7720  278.5030  454.2180  268.4050  218.1140  302.7420  342.2520  330.9760  227.0520  338.9210  351.5590 327.1600  399.1270  333.7130  328.3600  353.8830  371.1010  212.2540  291.4900  335.3180  320.1750  275.4330  369.9740  325.7110  496.0200  303.1590  452.3820  545.8550  396.2570  304.9500  407.6430 308.1710  349.8350  360.9320  335.8000  389.8740  326.2070  310.8500  277.1530  415.4400  354.8120  339.7660  225.7930  322.1640  297.9510  362.8140  307.7050  387.7920  329.0850  275.2220  458.1690 181.3340  225.1480  367.7250  393.1560  424.3570  451.1470  181.3210  263.8450  349.6620  266.5670  268.9700  348.8940  354.6530  388.6090  364.1590  332.3030  270.7510  289.3530  303.0580  328.5890
];


% intrinsics
K0=[
  666.2647   -1.9125  399.0122
         0  672.7446  265.9638
         0         0    1.0000
];

K1=[
  654.6456   -1.1537  389.9888
         0  647.5445  286.4156
         0         0    1.0000
];

% normalize points
npts0=inv(K0)*[pts0; ones(1, size(pts0,2))];
npts1=inv(K1)*[pts1; ones(1, size(pts1,2))];

E=ransacfitessmatrix(npts0, npts1, 0.001);
E
