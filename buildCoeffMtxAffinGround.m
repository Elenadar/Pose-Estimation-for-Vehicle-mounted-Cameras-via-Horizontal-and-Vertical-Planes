function C = buildCoeffMtxAffinGround(A,P,Q)
  sizeOfP = size(P);
  n = sizeOfP(1)*6;
  C = zeros(n,5);
  C(1:6:n,1) = 1-A(:,1);
  %C(1:6:n,2) = 0;
  C(1:6:n,3) = -Q(:,1)-A(:,1).*P(:,1);
  C(1:6:n,4) = -A(:,1).*P(:,2);
  %C(1:6:n,5) = 0;
  
  C(2:6:n,1) = -A(:,2);
  C(2:6:n,2) = 1;
  C(2:6:n,3) = -A(:,2).*P(:,1);
  C(2:6:n,4) = -Q(:,1)-A(:,2).*P(:,2);
  %C(2:6:n,5) = 0;
  
  C(3:6:n,1) = -A(:,3);
  %C(3:6:n,2) = 0;
  C(3:6:n,3) = -Q(:,2)-A(:,3).*P(:,1);
  C(3:6:n,4) = -A(:,3).*P(:,2);
  %C(3:6:n,5) = 0;
  
  C(4:6:n,1) = -A(:,4);
  %C(4:6:n,2) = 0;
  C(4:6:n,3) = -A(:,4).*P(:,1);
  C(4:6:n,4) = -Q(:,2)-A(:,4).*P(:,2);
  C(4:6:n,5) = 1;
  
  C(5:6:n,1) = P(:,1)-Q(:,1);
  C(5:6:n,2) = P(:,2);
  C(5:6:n,3) = -1-P(:,1).*Q(:,1);
  C(5:6:n,4) = -P(:,2).*Q(:,1);
  %C(5:6:n,5) = 0;
  
  C(6:6:n,1) = -Q(:,2);
  C(6:6:n,2) = 0;
  C(6:6:n,3) = -P(:,1).*Q(:,2);
  C(6:6:n,4) = -P(:,2).*Q(:,2);
  C(6:6:n,5) = P(:,2);
end